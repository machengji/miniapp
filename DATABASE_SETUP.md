# 数据库集合创建指南

## 需要创建的集合

### 1. dreams（梦境记录）- 如果还没创建

```
云开发控制台 → 数据库
→ 点击 "+ 添加集合"
→ 输入：dreams
→ 点击 "确定"

数据权限设置：
{
  "read": true,
  "write": "doc._openid == auth.openid"
}
```

### 2. users（用户档案）- **现在需要创建**

```
云开发控制台 → 数据库
→ 点击 "+ 添加集合"
→ 输入：users
→ 点击 "确定"

数据权限设置：
{
  "read": "doc._openid == auth.openid",
  "write": "doc._openid == auth.openid"
}
```

---

## 创建步骤（图文）

```
┌─────────────────────────────────────┐
│  云开发控制台                        │
│  ├── 概览                            │
│  ├── 数据库  ◄── 点击这里            │
│  ├── 存储                            │
│  ├── 云函数                          │
│  └── 扩展功能                        │
└─────────────────────────────────────┘

        ↓

┌─────────────────────────────────────┐
│  数据库页面                          │
│                                     │
│  + 添加集合  ◄── 点击这里            │
│                                     │
│  （已有集合列表）                     │
│  ├── dreams                         │
│  └── users                          │
└─────────────────────────────────────┘

        ↓

┌─────────────────────────────────────┐
│  输入集合名称：users                 │
│                                     │
│  [确定]                             │
└─────────────────────────────────────┘

        ↓

┌─────────────────────────────────────┐
│  点击 users 集合                     │
│  → 数据权限 标签                     │
│  → 选择 "自定义权限"                 │
│  → 粘贴权限配置                      │
└─────────────────────────────────────┘
```

---

## 验证是否创建成功

创建完成后，刷新小程序，控制台应该看到：

```
用户档案初始化: {success: true, isNewUser: true, user: {...}}
开始加载梦境列表...
梦境列表加载成功: x 条记录
```

---

## 如果还是看不到卡片

可能是 ** dreams 集合为空**（没有记录过梦境），这时应该显示空状态：

```
🌙
尚未记录任何梦境
点击右下角按钮，开启你的潜意识探索之旅
```

这是正常的！你需要先去记录一个梦境。

### 快速测试流程：

1. 创建 users 集合 ✓
2. 点击首页右下角 **+** 按钮
3. 输入测试内容："我梦见自己在飞"
4. 选择情绪，发送
5. 等待AI回复并保存
6. 返回首页
7. 应该能看到卡片了！
